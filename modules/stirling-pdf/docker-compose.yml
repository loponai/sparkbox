# ==========================================
# SPARKBOX - Stirling PDF Module
# All-in-one PDF tools
# ==========================================

x-sparkbox:
  id: stirling-pdf
  title: "Stirling PDF"
  tagline: "Merge, split, convert, and edit PDFs"
  description: "A powerful, self-hosted PDF toolkit. Merge, split, rotate, convert, compress, and watermark PDFs right in your browser. No files ever leave your server."
  icon: "file"
  category: "documents"
  required: false
  default: false
  ram: "~200MB"
  theme:
    emoji: "\uD83D\uDCD1"
    color: "#e74c3c"
    bg: "rgba(231,76,60,0.12)"
  tips:
    - "Drag and drop PDFs into the browser to start editing"
    - "Use the merge tool to combine multiple PDFs into a single document"
  services:
    stirling-pdf:
      friendly_name: "Stirling PDF"
      description: "All-in-one PDF manipulation toolkit"
      port_map: 8085
      tip: "Upload a PDF or use the built-in tools to create, merge, and convert documents"

networks:
  sb_proxy:
    external: true
  sb_stirling-pdf:
    driver: bridge
    ipam:
      config:
        - subnet: 172.20.12.0/24

services:
  # --- Stirling PDF ---
  # All-in-one PDF tools
  stirling-pdf:
    image: stirlingtools/stirling-pdf:0.36.5
    container_name: sb-stirling-pdf
    ports:
      - "127.0.0.1:8085:8080"
    environment:
      - TZ=${TZ:-UTC}
      - DOCKER_ENABLE_SECURITY=false
    volumes:
      - ${SB_ROOT:-/opt/sparkbox}/modules/stirling-pdf/config/data:/usr/share/tessdata
      - ${SB_ROOT:-/opt/sparkbox}/modules/stirling-pdf/config/configs:/configs
      - ${SB_ROOT:-/opt/sparkbox}/modules/stirling-pdf/config/logs:/logs
    networks:
      - sb_stirling-pdf
      - sb_proxy
    deploy:
      resources:
        limits:
          memory: 512M
          cpus: '1.00'
    security_opt:
      - no-new-privileges:true
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:8080/api/v1/info/status"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 30s
    logging:
      driver: json-file
      options:
        max-size: "10m"
        max-file: "3"
    restart: always
